import{_ as H,o as R,a as $,b as n,c as i,d as t,e as h,w as A,F as x,r as V,T as U,f as B,n as E,g as _,h as j,i as u,j as D,u as G,k as O,l as P,t as y,v as W,m as q}from"./index-yptzv2Gs.js";import{u as J,_ as K}from"./LoadingSpinner-BgCI5orC.js";import{M as g}from"./MediaRow-D2uU2rYO.js";import"./MediaCard-BGe4CHWK.js";const Q={class:"p-6 space-y-8"},X={key:0,class:"relative h-96 rounded-2xl overflow-hidden group"},Y={class:"relative w-full h-full"},Z=["src","alt"],ee={class:"relative h-full flex flex-col justify-end p-8"},te={class:"flex items-center gap-3 mb-3"},le={key:0,class:"flex items-center gap-1 text-yellow-400 text-sm"},se={class:"text-4xl font-bold text-white mb-2"},ae={class:"text-dark-300 max-w-xl line-clamp-2 mb-12"},oe={class:"absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2"},ne=["onClick"],re={class:"absolute bottom-0 left-0 right-0 h-1 bg-dark-800/50"},z=8e3,ie={__name:"HomeView",setup(ue){const M=G(),c=J(),f=u(!0),b=u([]),k=u([]),C=u([]),a=u(0),p=u(null),m=u(null),v=u(0),r=D(()=>{const l=b.value.slice(0,4),e=k.value.slice(0,3),s=[],o=Math.max(l.length,e.length);for(let d=0;d<o;d++)l[d]&&s.push({...l[d],mediaType:"movie"}),e[d]&&s.push({...e[d],mediaType:"tv"});return s.slice(0,7)}),T=D(()=>c.history.slice(0,10).map(l=>({id:l.tmdb_id,title:l.title,poster_path:l.poster,vote_average:0}))),w=()=>{S(),v.value=0;const l=100/(z/100);m.value=setInterval(()=>{v.value+=l},100),p.value=setInterval(()=>{I()},z)},S=()=>{p.value&&(clearInterval(p.value),p.value=null),m.value&&(clearInterval(m.value),m.value=null)},I=()=>{a.value=(a.value+1)%r.value.length,v.value=0},L=()=>{a.value=a.value===0?r.value.length-1:a.value-1,v.value=0,w()},N=l=>{a.value=l,v.value=0,w()},F=(l,e)=>{var o;(((o=r.value[e])==null?void 0:o.mediaType)||"movie")==="tv"?M.push({name:"TVDetails",params:{id:l.id}}):M.push({name:"MovieDetails",params:{id:l.id}})};return R(async()=>{f.value=!0;try{const[l,e,s]=await Promise.all([c.fetchTrendingMovies(),c.fetchTrendingTV(),c.fetchAnimationMovies(),c.loadHistory()]);b.value=(l==null?void 0:l.results)||[],k.value=(e==null?void 0:e.results)||[],C.value=(s==null?void 0:s.results)||[],r.value.length>0&&w()}catch(l){console.error("Failed to load home content:",l)}finally{f.value=!1}}),$(()=>{S()}),(l,e)=>(n(),i("div",Q,[r.value.length>0?(n(),i("section",X,[t("div",Y,[h(U,{name:"carousel"},{default:A(()=>[(n(!0),i(x,null,V(r.value,(s,o)=>O((n(),i("div",{key:s.id,class:"absolute inset-0"},[t("img",{src:P(c).getImageURL(s.backdrop_path,"w1280"),alt:s.title||s.name,class:"absolute inset-0 w-full h-full object-cover",draggable:"false"},null,8,Z),e[3]||(e[3]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-dark-900 via-dark-900/70 to-transparent"},null,-1)),e[4]||(e[4]=t("div",{class:"absolute inset-0 bg-gradient-to-t from-dark-900 via-transparent to-transparent"},null,-1)),t("div",ee,[t("div",te,[e[2]||(e[2]=t("span",{class:"px-3 py-1 bg-accent-600 text-white text-xs font-medium rounded-full"}," Рекомендуем ",-1)),s.vote_average?(n(),i("span",le,[e[1]||(e[1]=t("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1)),B(" "+y(s.vote_average.toFixed(1)),1)])):_("",!0)]),t("h1",se,y(s.title||s.name),1),t("p",ae,y(s.overview),1)])])),[[W,o===a.value]])),128))]),_:1})]),t("button",{onClick:e[0]||(e[0]=s=>F(r.value[a.value],a.value)),class:"absolute left-8 bottom-6 btn-primary flex items-center gap-2"},[...e[5]||(e[5]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),B(" Смотреть ",-1)])]),t("div",oe,[(n(!0),i(x,null,V(r.value,(s,o)=>(n(),i("button",{key:o,onClick:d=>N(o),class:q(["w-2 h-2 rounded-full transition-all duration-300",o===a.value?"bg-accent-500 w-6":"bg-white/50 hover:bg-white/80"])},null,10,ne))),128))]),t("div",{class:"absolute right-4 bottom-6 flex gap-2"},[t("button",{onClick:L,class:"p-2.5 bg-dark-900/70 backdrop-blur-sm rounded-lg text-white hover:bg-dark-800 transition-colors duration-200"},[...e[6]||(e[6]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),t("button",{onClick:I,class:"p-2.5 bg-dark-900/70 backdrop-blur-sm rounded-lg text-white hover:bg-dark-800 transition-colors duration-200"},[...e[7]||(e[7]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])])]),t("div",re,[t("div",{class:"h-full bg-accent-600 transition-all duration-100",style:E({width:`${v.value}%`})},null,4)])])):_("",!0),f.value?(n(),j(K,{key:1,text:"Загрузка контента..."})):(n(),i(x,{key:2},[h(g,{title:"Популярные фильмы",items:b.value,type:"movie"},null,8,["items"]),h(g,{title:"Популярные сериалы",items:k.value,type:"tv"},null,8,["items"]),h(g,{title:"Мультфильмы",items:C.value,type:"movie"},null,8,["items"]),T.value.length>0?(n(),j(g,{key:0,title:"Продолжить просмотр",items:T.value,type:"movie"},null,8,["items"])):_("",!0)],64))]))}},me=H(ie,[["__scopeId","data-v-87191efb"]]);export{me as default};
