import{o as f,b as n,c as r,d as t,f as g,g as u,h as y,F as b,r as w,i as h,u as M,t as i,n as C,s as j}from"./index-yptzv2Gs.js";import{u as B,_ as D}from"./LoadingSpinner-BgCI5orC.js";const V={class:"p-6"},$={class:"flex items-center justify-between mb-6"},H={key:1,class:"flex flex-col items-center justify-center h-64 text-center"},L={key:2,class:"space-y-4"},z=["onClick"],N=["src","alt"],R={class:"flex-1 min-w-0"},S={class:"font-medium text-white text-lg mb-1"},A={key:0,class:"text-dark-400 text-sm mb-2"},U={class:"mt-2"},F={class:"flex items-center justify-between text-xs text-dark-400 mb-1"},I={class:"h-1.5 bg-dark-700 rounded-full overflow-hidden"},T={class:"text-dark-500 text-xs mt-2"},q=["onClick"],G={__name:"HistoryView",setup(E){const c=M(),l=B(),a=h([]),d=h(!0),m=s=>l.getImageURL(s,"w185"),p=s=>s?new Date(s).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",k=s=>{const e=s.media_type==="tv"?"TVDetails":"MovieDetails";c.push({name:e,params:{id:s.tmdb_id}})},x=s=>{c.push({name:"Player",query:{tmdb_id:s.tmdb_id,media_type:s.media_type,title:s.title}})},_=async()=>{await l.clearHistory(),a.value=[]};return f(async()=>{d.value=!0,await l.loadHistory(),a.value=l.history,d.value=!1}),(s,e)=>(n(),r("div",V,[t("div",$,[e[1]||(e[1]=t("h1",{class:"text-2xl font-bold text-white"},"История просмотров",-1)),a.value.length>0?(n(),r("button",{key:0,onClick:_,class:"btn-secondary text-sm flex items-center gap-2"},[...e[0]||(e[0]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),g(" Очистить историю ",-1)])])):u("",!0)]),d.value?(n(),y(D,{key:0,text:"Загрузка истории..."})):a.value.length===0?(n(),r("div",H,[...e[2]||(e[2]=[t("svg",{class:"w-16 h-16 text-dark-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),t("h3",{class:"text-lg font-medium text-dark-400 mb-2"},"История пуста",-1),t("p",{class:"text-dark-500 text-sm"},"Здесь будут отображаться просмотренные фильмы и сериалы",-1)])])):(n(),r("div",L,[(n(!0),r(b,null,w(a.value,o=>(n(),r("div",{key:`${o.media_type}-${o.tmdb_id}`,class:"bg-dark-800 rounded-xl p-4 flex gap-4 hover:bg-dark-700/80 transition-colors cursor-pointer",onClick:v=>k(o)},[t("img",{src:m(o.poster),alt:o.title,class:"w-20 h-28 object-cover rounded-lg flex-shrink-0",draggable:"false"},null,8,N),t("div",R,[t("h3",S,i(o.title),1),o.episode?(n(),r("p",A,i(o.episode),1)):u("",!0),t("div",U,[t("div",F,[e[3]||(e[3]=t("span",null,"Прогресс",-1)),t("span",null,i(Math.round(o.progress))+"%",1)]),t("div",I,[t("div",{class:"h-full bg-accent-500 rounded-full transition-all",style:C({width:`${o.progress}%`})},null,4)])]),t("p",T,i(p(o.last_watched)),1)]),t("button",{onClick:j(v=>x(o),["stop"]),class:"flex-shrink-0 self-center p-3 bg-accent-600 hover:bg-accent-700 rounded-full transition-colors"},[...e[4]||(e[4]=[t("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],8,q)],8,z))),128))]))]))}};export{G as default};
